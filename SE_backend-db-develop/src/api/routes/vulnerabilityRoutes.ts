import { Router } from "express";
import { vulnerabilityServices } from "../services/vulnerabilityServices";
import { vulnerabilitySchema } from "../schemas/requestBodySchema";
import { validateData } from "../middlewares/validationMiddleware";
import { checkAuthenticated } from "../middlewares/auth";
import { checkAdmin } from "../middlewares/rolesChecker";
import { 
  getAllVulnerabilities, 
  getVulnerabilityById, 
  createVulnerability, 
  updateVulnerability, 
  deleteVulnerability 
} from "../controllers/vulnerabilityController";

const vulnerabilityRoutes = Router();

vulnerabilityRoutes.route('/')
  .get(checkAuthenticated, getAllVulnerabilities)
  .post(checkAuthenticated, checkAdmin, validateData(vulnerabilitySchema), createVulnerability);

vulnerabilityRoutes.route('/:id')
  .get(checkAuthenticated, getVulnerabilityById)
  .put(checkAuthenticated, checkAdmin, validateData(vulnerabilitySchema), updateVulnerability)
  .delete(checkAuthenticated, checkAdmin, deleteVulnerability);

export default vulnerabilityRoutes;
